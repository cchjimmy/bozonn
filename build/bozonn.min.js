var bozonn=(()=>{var c=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var f=c((pe,L)=>{function p(e,t){return Math.random()*(t-e)+e}function k(e,t,r,n){r??=-1,n??=1;let u=new Array(e);for(let l=0;l<e;l++){u[l]=new Array(t);for(let o=0;o<t;o++)u[l][o]=p(r,n)}return u}function P(e,t,r){return r??=1e-5,(e(t+r)-e(t-r))/(2*r)}function V(e,t,r){r??=0;let n=new Array(e),u=new Array(t).fill(r);for(let l=0;l<e;l++)n[l]=u.slice();return n}function Y(e){let t=[];for(let r=0;r<e.length;r++)t[r]=e.splice();return t}function _(e){let t=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;for(let n=0,u=e.length;n<u;n++)for(let l=0,o=e[n].length;l<o;l++){let i=e[n][l];t=i<t?i:t,r=i>r?i:r}return[t,r]}function C(e,t,r){return(r-e)/(t-e)}function O(e,t){let r=e.length,n=new Array(r);for(let u=0;u<r;u++)n[u]=e[u].map((l,o)=>t(l,u,o));return n}L.exports={random:p,random2D:k,derivative1D:P,fill2D:V,copy2D:Y,findMinMax2D:_,percent:C,map2D:O}});var h=c((Le,d)=>{function R(e){return e}function G(e){return 1/(1+Math.exp(-e))}d.exports={identity:R,sigmoid:G}});var y=c((de,D)=>{var{random2D:W}=f(),{identity:$}=h();function B(...e){return{layers:e}}function H(e,t){for(let r=0;r<e.layers.length;r++)t=q(e.layers[r],t);return t}function q(e,t){let r=t.length,n=e.weights[0].length,u=t[0].length+1,l=new Array(r);for(let o=0;o<r;o++){l[o]=new Array(n),t[o].push(1);for(let i=0;i<n;i++){l[o][i]=0;for(let s=0;s<u;s++)l[o][i]+=t[o][s]*e.weights[s][i];l[o][i]=e.activationFn(l[o][i])}t[o].pop()}return l}function J(e,t,r){let n=W(e+1,t);return r??=$,{weights:n,activationFn:r}}function K(e,t,r,n,u,l){console.log("training starts");let o;for(let i=0;i<n;i++)o=e(t,r,u,l),i%(n/5)==0&&console.log(`progress: ${i/n*100}%`);return console.log(`progress: 100%
training ends`),o}D.exports={createLayer:J,createModel:B,train:K,processLayer:q,predict:H}});var M=c((qe,I)=>{var{findMinMax2D:Q,map2D:S,percent:U}=f();function X(e){let[t,r]=Q(e);return S(e,n=>U(t,r,n))}I.exports={softmax:X}});var w=c((De,A)=>{var{map2D:a}=f();function Z(e){return a(e,t=>Math.abs(t))}function x(e){let t=e.length,r=e[0].length,n=0;for(let u=0;u<t;u++)for(let l=0;l<r;l++)n+=e[u][l];return n}function z(e,t){let r=e.length,n=t[0].length,u=e[0].length,l=new Array(r);for(let o=0;o<e.length;o++){l[o]=new Array(n);for(let i=0;i<n;i++){let s=0;for(let g=0;g<u;g++)s+=e[o][g]*t[g][i];l[o][i]=s}}return l}function ee(e,t){return a(e,(r,n,u)=>r+t[n][u])}function te(e,t){return a(e,(r,n,u)=>r-t[n][u])}function re(e,t){return a(e,r=>r-t)}function ne(e,t){return a(e,r=>r*t)}function le(e,t){return a(e,r=>r**t)}function oe(e){return x(e)/(e.length*e[0].length)}A.exports={abs:Z,sum:x,multM:z,addM:ee,subM:te,subS:re,multS:ne,power:le,mean:oe}});var v=c((Ae,N)=>{var{addM:ue,multS:ie,subM:Ie}=w(),{random2D:se,derivative1D:Me}=f(),{predict:b,processLayer:xe}=y();function ce(e){return(t,r,n,u)=>{let l=t(u,b(r,n));if(l<e)return l;let o=r.layers.map(s=>s.weights),i=Number.POSITIVE_INFINITY;for(;i>l;){for(let s=0;s<o.length;s++)r.layers[s].weights=ue(o[s],ie(se(o[s].length,o[s][0].length),e));i=t(u,b(r,n))}return i}}N.exports={evolution:ce}});var j=c((be,F)=>{var{abs:ae,subM:m,power:fe,mean:E}=w();function ge(e,t){return E(ae(m(e,t)))}function he(e,t){return E(fe(m(e,t),2))}F.exports={meanAbsoluteError:ge,meanSquareError:he}});var ye=c((Ne,T)=>{T.exports={nN:y(),activationFns:h(),outputProcessFns:M(),optimizers:v(),lossFns:j()}});return ye();})();
